# Stellar Soroban GMP Example

Axelar [General Message Passing (GMP)](https://www.axelar.network/blog/general-message-passing-and-how-can-it-change-web3) allows for messages to be sent between two chains. Such messages can be used to power natively cross-chain decentralized applications. With the integration of Stellar to Axelar, Soroban based contracts can now send messages to other [blockchain ecosystems](https://docs.axelar.dev/dev/reference/mainnet-chain-names) connected to Axelar, including (but not limited to) EVM chains.

## Setup

To begin, make sure the [Stellar CLI](https://github.com/stellar/stellar-cli) is [setup](https://developers.stellar.org/docs/build/smart-contracts/getting-started/setup) on your local machine.

Once the Stellar CLI is setup you can run `stellar contract init axelar-gmp`. This will create a new Stellar Soroban project.

Now that you have a Stellar project you can run `cargo install axelar-cgp-soroban` to install the Axelar related functionality to be used in your contract.

## Contract

### Constructor

In the [constructor](https://github.com/stellar/stellar-protocol/blob/5ef1b45cbab54f57c5ddfc98adb964f26b68bb3b/core/cap-0058.md) function you will need to pass in the Axelar [Gateway]("/dev/general-message-passing/soroban-gmp/soroban-contracts/#soroban-gateway") and [Gas Service]("/dev/general-message-passing/soroban-gmp/soroban-contracts/#soroban-gas-service") contracts.

```rust
pub fn __constructor(env: Env, gateway: Address, gas_service: Address) {}
```

Note: In addition to the `gateway` and `gas service` you will also set an `env` param. This is an instance of the Env struct, which is a core part of the Soroban SDK. The Env struct provides access to various environment-specific functions and capabilities necessary for interacting with the contract's storage, managing resources, and executing contract logic within the Soroban runtime.



### Storage

The `gateway` and `gas service` contracts can be stored in the contract's [instance storage](https://developers.stellar.org/docs/learn/encyclopedia/storage/state-archival#instance). Before you can save the two parameters in storage, you must first define the storage variables. Create a new file called `storage_types.rs`

This can be done as follows:

```rust
use soroban_sdk::contracttype;

#[contracttype]
#[derive(Clone, Debug)]
pub enum DataKey {
    Gateway,
    GasService,
}
```

The `storage_types.rs` file defines the DataKey enum, used as a typed storage key within the contract.

`#[contracttype]`: Marks the enum for serialization and storage by the Soroban SDK.
Enum Variants:
Gateway: Represents the storage key for the gateway contract.
GasService: Represents the storage key for the gas service contract.

With the storage now setup you can store your `gateway` and `gas serivce` contracts in storage from the `constructor`. The complete `constructor` should now look like this.

```rust
  pub fn __constructor(env: Env, gateway: Address, gas_service: Address) {
        env.storage().instance().set(&DataKey::Gateway, &gateway);
        env.storage()
            .instance()
            .set(&DataKey::GasService, &gas_service);
    }
```
 
 The constructor stores each param at a specific `key` in the `DataKey` `enum` you created before.

 